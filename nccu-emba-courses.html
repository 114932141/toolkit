<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÂúãÁ´ãÊîøÊ≤ªÂ§ßÂ≠∏ EMBA Ë™≤Á®ãË≥áË®ä</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Microsoft JhengHei", sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #e8e8e8;
        }
        
        .header {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding: 16px;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            max-width: 1600px;
            margin: 0 auto;
        }
        
        .header-top {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            margin-bottom: 12px;
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
            min-width: 0;
        }
        
        .logo {
            width: 44px;
            height: 44px;
            background: linear-gradient(135deg, #8b1e3f 0%, #c62828 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: bold;
            color: white;
            flex-shrink: 0;
        }
        
        .title-wrap {
            min-width: 0;
        }
        
        h1 {
            font-size: 18px;
            font-weight: 600;
            background: linear-gradient(90deg, #fff, #a8dadc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .subtitle {
            font-size: 11px;
            color: #888;
            margin-top: 2px;
        }
        
        .stats {
            display: flex;
            gap: 16px;
            flex-shrink: 0;
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-value {
            font-size: 20px;
            font-weight: 700;
            color: #4dabf7;
        }
        
        .stat-value.selected {
            color: #51cf66;
        }
        
        .stat-label {
            font-size: 10px;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .view-row {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .view-toggle {
            display: flex;
            background: rgba(255,255,255,0.08);
            border-radius: 8px;
            padding: 3px;
            flex: 1;
            min-width: 0;
        }
        
        .view-btn {
            flex: 1;
            padding: 8px 10px;
            border: none;
            background: transparent;
            color: #888;
            font-size: 12px;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            white-space: nowrap;
        }
        
        .view-btn:hover {
            color: #fff;
        }
        
        .view-btn.active {
            background: #4dabf7;
            color: #fff;
        }
        
        .filter-toggle-btn {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 12px;
            background: rgba(255,255,255,0.08);
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 8px;
            color: #aaa;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
            flex-shrink: 0;
        }
        
        .filter-toggle-btn:hover, .filter-toggle-btn.active {
            background: rgba(255,255,255,0.15);
            color: #fff;
            border-color: rgba(255,255,255,0.3);
        }
        
        .filter-toggle-btn .arrow {
            transition: transform 0.3s;
        }
        
        .filter-toggle-btn.active .arrow {
            transform: rotate(180deg);
        }
        
        .controls {
            display: none;
            flex-direction: column;
            gap: 10px;
            padding-top: 12px;
            border-top: 1px solid rgba(255,255,255,0.1);
            margin-top: 12px;
        }
        
        .controls.show {
            display: flex;
        }
        
        .control-row {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .control-group {
            display: flex;
            align-items: center;
            gap: 6px;
            flex: 1;
            min-width: 140px;
        }
        
        .control-label {
            font-size: 11px;
            color: #aaa;
            font-weight: 500;
            flex-shrink: 0;
        }
        
        select, input {
            flex: 1;
            padding: 8px 10px;
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 6px;
            background: rgba(255,255,255,0.08);
            color: #fff;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
            min-width: 0;
        }
        
        select:hover, input:hover {
            border-color: rgba(255,255,255,0.3);
            background: rgba(255,255,255,0.12);
        }
        
        select:focus, input:focus {
            outline: none;
            border-color: #4dabf7;
        }
        
        select option {
            background: #1a1a2e;
            color: #fff;
        }
        
        .search-box {
            width: 100%;
        }
        
        .filter-toggle {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            padding: 8px 14px;
            background: rgba(81, 207, 102, 0.1);
            border: 1px solid rgba(81, 207, 102, 0.3);
            border-radius: 6px;
            color: #51cf66;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
            flex-shrink: 0;
        }
        
        .filter-toggle:hover {
            background: rgba(81, 207, 102, 0.2);
        }
        
        .filter-toggle.active {
            background: #51cf66;
            color: #fff;
        }
        
        .clear-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            padding: 8px 14px;
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid rgba(255, 107, 107, 0.3);
            border-radius: 6px;
            color: #ff6b6b;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
            flex-shrink: 0;
        }
        
        .clear-btn:hover {
            background: rgba(255, 107, 107, 0.2);
        }
        
        .save-indicator {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 11px;
            color: #888;
            padding: 4px 8px;
            background: rgba(255,255,255,0.05);
            border-radius: 4px;
        }
        
        .save-indicator.saved {
            color: #51cf66;
        }
        
        .main-content {
            max-width: 1600px;
            margin: 0 auto;
            padding: 16px;
        }
        
        .view-container {
            display: none;
        }
        
        .view-container.active {
            display: block;
        }
        
        .course-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 16px;
        }
        
        .course-card {
            background: rgba(255,255,255,0.06);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 16px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .course-card:hover {
            border-color: rgba(77,171,247,0.4);
            box-shadow: 0 8px 24px rgba(0,0,0,0.3);
        }
        
        .course-card.selected {
            border-color: rgba(81, 207, 102, 0.6);
            background: rgba(81, 207, 102, 0.08);
        }
        
        .course-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
        }
        
        .course-card[data-group="ÂÖ®‰ºÅÁµÑ"]::before { background: linear-gradient(90deg, #e63946, #f77f00); }
        .course-card[data-group="ÂúãÈáëÁµÑ"]::before { background: linear-gradient(90deg, #2a9d8f, #40916c); }
        .course-card[data-group="ÁîüÈÜ´ÁµÑ"]::before { background: linear-gradient(90deg, #9d4edd, #c77dff); }
        .course-card[data-group="ÊñáÁßëË≥áÂâµÁµÑ"]::before { background: linear-gradient(90deg, #0077b6, #00b4d8); }
        .course-card[data-group="‰∏çÂàÜÁµÑ"]::before { background: linear-gradient(90deg, #6c757d, #adb5bd); }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 8px;
            margin-bottom: 12px;
        }
        
        .card-checkbox {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            flex: 1;
            min-width: 0;
        }
        
        .checkbox-wrapper {
            position: relative;
            width: 22px;
            height: 22px;
            flex-shrink: 0;
            margin-top: 2px;
        }
        
        .checkbox-wrapper input {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
            z-index: 1;
        }
        
        .checkbox-custom {
            position: absolute;
            top: 0;
            left: 0;
            width: 22px;
            height: 22px;
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 5px;
            transition: all 0.2s;
        }
        
        .checkbox-wrapper input:checked + .checkbox-custom {
            background: #51cf66;
            border-color: #51cf66;
        }
        
        .checkbox-custom::after {
            content: '‚úì';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            color: white;
            font-size: 12px;
            font-weight: bold;
            transition: transform 0.2s;
        }
        
        .checkbox-wrapper input:checked + .checkbox-custom::after {
            transform: translate(-50%, -50%) scale(1);
        }
        
        .course-name {
            font-size: 15px;
            font-weight: 600;
            color: #fff;
            line-height: 1.4;
        }
        
        .group-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
            white-space: nowrap;
            flex-shrink: 0;
        }
        
        .group-badge[data-group="ÂÖ®‰ºÅÁµÑ"] { background: rgba(230,57,70,0.2); color: #f77f00; }
        .group-badge[data-group="ÂúãÈáëÁµÑ"] { background: rgba(42,157,143,0.2); color: #40916c; }
        .group-badge[data-group="ÁîüÈÜ´ÁµÑ"] { background: rgba(157,78,221,0.2); color: #c77dff; }
        .group-badge[data-group="ÊñáÁßëË≥áÂâµÁµÑ"] { background: rgba(0,119,182,0.2); color: #00b4d8; }
        .group-badge[data-group="‰∏çÂàÜÁµÑ"] { background: rgba(108,117,125,0.2); color: #adb5bd; }
        
        .card-info {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .info-row {
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }
        
        .info-icon {
            width: 28px;
            height: 28px;
            border-radius: 6px;
            background: rgba(255,255,255,0.08);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            flex-shrink: 0;
        }
        
        .info-content {
            flex: 1;
            min-width: 0;
        }
        
        .info-label {
            font-size: 10px;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 2px;
        }
        
        .info-value {
            font-size: 13px;
            color: #e8e8e8;
            line-height: 1.4;
        }
        
        .credits-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            background: linear-gradient(135deg, #4dabf7, #339af0);
            padding: 3px 10px;
            border-radius: 10px;
            font-size: 12px;
            font-weight: 600;
            color: #fff;
        }
        
        .syllabus-link {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 6px 12px;
            background: rgba(255,107,107,0.15);
            border: 1px solid rgba(255,107,107,0.3);
            border-radius: 6px;
            color: #ff6b6b;
            text-decoration: none;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.2s;
            cursor: pointer;
            position: relative;
            z-index: 10;
        }
        
        .syllabus-link:hover {
            background: rgba(255,107,107,0.3);
            border-color: rgba(255,107,107,0.6);
        }
        
        .date-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            margin-top: 2px;
        }
        
        .date-chip {
            padding: 3px 8px;
            background: rgba(255,255,255,0.08);
            border-radius: 4px;
            font-size: 11px;
            color: #aaa;
        }
        
        .time-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
        }
        
        .time-chip {
            padding: 3px 8px;
            background: rgba(77,171,247,0.15);
            border-radius: 4px;
            font-size: 11px;
            color: #4dabf7;
        }
        
        /* Time Slot View */
        .time-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 16px;
        }
        
        .time-slot-card {
            background: rgba(255,255,255,0.04);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            overflow: hidden;
        }
        
        .time-slot-header {
            padding: 12px 16px;
            background: rgba(255,255,255,0.06);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .time-slot-title {
            font-size: 14px;
            font-weight: 600;
            color: #fff;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .time-slot-icon {
            font-size: 16px;
        }
        
        .time-slot-count {
            background: #4dabf7;
            color: #fff;
            padding: 3px 10px;
            border-radius: 10px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .time-slot-courses {
            padding: 12px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .time-course-item {
            background: rgba(255,255,255,0.06);
            border-radius: 8px;
            padding: 12px;
            transition: all 0.2s;
            cursor: pointer;
        }
        
        .time-course-item:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .time-course-item.selected {
            background: rgba(81, 207, 102, 0.15);
            border: 1px solid rgba(81, 207, 102, 0.3);
        }
        
        .time-course-name {
            font-size: 13px;
            font-weight: 600;
            color: #fff;
            margin-bottom: 6px;
        }
        
        .time-course-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            font-size: 11px;
        }
        
        .time-course-tag {
            padding: 2px 6px;
            border-radius: 4px;
            background: rgba(255,255,255,0.08);
            color: #aaa;
        }
        
        .time-course-tag.group {
            background: rgba(77,171,247,0.2);
            color: #4dabf7;
        }
        
        /* Calendar View */
        .calendar-container {
            background: rgba(255,255,255,0.04);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            overflow: hidden;
        }
        
        .calendar-header {
            padding: 12px 16px;
            background: rgba(255,255,255,0.06);
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .calendar-title {
            font-size: 16px;
            font-weight: 600;
            color: #fff;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
        }
        
        .calendar-legend {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 11px;
            color: #aaa;
        }
        
        .legend-dot {
            width: 10px;
            height: 10px;
            border-radius: 2px;
        }
        
        .legend-dot[data-group="ÂÖ®‰ºÅÁµÑ"] { background: #f77f00; }
        .legend-dot[data-group="ÂúãÈáëÁµÑ"] { background: #40916c; }
        .legend-dot[data-group="ÁîüÈÜ´ÁµÑ"] { background: #c77dff; }
        .legend-dot[data-group="ÊñáÁßëË≥áÂâµÁµÑ"] { background: #00b4d8; }
        .legend-dot[data-group="‰∏çÂàÜÁµÑ"] { background: #adb5bd; }
        .legend-dot.selected { background: #51cf66; }
        
        .time-legend {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            padding: 10px 16px;
            background: rgba(255,255,255,0.03);
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .time-legend-item {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 11px;
            color: #aaa;
        }
        
        .time-symbol {
            font-size: 11px;
            font-weight: bold;
        }
        
        .time-symbol.morning { color: #ffd43b; }
        .time-symbol.afternoon { color: #ff922b; }
        .time-symbol.evening { color: #845ef7; }
        .time-symbol.allday { color: #20c997; }
        
        .calendar-body {
            padding: 16px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .calendar-timeline {
            display: flex;
            flex-direction: column;
            gap: 2px;
            min-width: 900px;
        }
        
        .calendar-row {
            display: flex;
            align-items: stretch;
            min-height: 36px;
            cursor: pointer;
        }
        
        .calendar-row:hover {
            background: rgba(255,255,255,0.02);
        }
        
        .calendar-row-label {
            width: 160px;
            min-width: 160px;
            padding: 6px 10px;
            font-size: 11px;
            font-weight: 500;
            color: #fff;
            background: rgba(255,255,255,0.04);
            border-right: 1px solid rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .calendar-row-label .group-indicator {
            width: 3px;
            height: 100%;
            min-height: 24px;
            border-radius: 2px;
        }
        
        .calendar-row-label .group-indicator[data-group="ÂÖ®‰ºÅÁµÑ"] { background: #f77f00; }
        .calendar-row-label .group-indicator[data-group="ÂúãÈáëÁµÑ"] { background: #40916c; }
        .calendar-row-label .group-indicator[data-group="ÁîüÈÜ´ÁµÑ"] { background: #c77dff; }
        .calendar-row-label .group-indicator[data-group="ÊñáÁßëË≥áÂâµÁµÑ"] { background: #00b4d8; }
        .calendar-row-label .group-indicator[data-group="‰∏çÂàÜÁµÑ"] { background: #adb5bd; }
        
        .calendar-row-dates {
            flex: 1;
            display: flex;
            position: relative;
            background: rgba(255,255,255,0.02);
        }
        
        .date-cell {
            flex: 1;
            min-width: 22px;
            border-right: 1px solid rgba(255,255,255,0.05);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .date-cell.weekend {
            background: rgba(255,255,255,0.02);
        }
        
        .date-cell.has-class {
            background: rgba(77,171,247,0.15);
        }
        
        .date-cell.has-class.selected {
            background: rgba(81, 207, 102, 0.25);
        }
        
        .date-marker {
            font-size: 10px;
            font-weight: bold;
        }
        
        .date-marker.morning { color: #ffd43b; }
        .date-marker.afternoon { color: #ff922b; }
        .date-marker.evening { color: #845ef7; }
        .date-marker.allday { color: #20c997; }
        
        .date-header-row {
            display: flex;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 4px;
        }
        
        .date-header-spacer {
            width: 160px;
            min-width: 160px;
        }
        
        .date-headers {
            flex: 1;
            display: flex;
        }
        
        .date-header {
            flex: 1;
            min-width: 22px;
            text-align: center;
            font-size: 9px;
            color: #666;
            padding: 3px 0;
        }
        
        .date-header.weekend {
            color: #888;
        }
        
        .date-header .day-num {
            font-weight: 600;
            font-size: 10px;
            color: #aaa;
        }
        
        .date-header.weekend .day-num {
            color: #f77f00;
        }
        
        .month-divider::before {
            content: '';
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            width: 2px;
            background: rgba(77,171,247,0.5);
        }
        
        .calendar-row.selected .calendar-row-label {
            background: rgba(81, 207, 102, 0.1);
        }
        
        .empty-state {
            grid-column: 1 / -1;
            text-align: center;
            padding: 40px 20px;
            color: #888;
        }
        
        .empty-state-icon {
            font-size: 40px;
            margin-bottom: 12px;
            opacity: 0.5;
        }
        
        /* Desktop styles */
        @media (min-width: 769px) {
            .header {
                padding: 20px 24px;
            }
            
            .logo {
                width: 50px;
                height: 50px;
                font-size: 20px;
            }
            
            h1 {
                font-size: 24px;
            }
            
            .subtitle {
                font-size: 13px;
            }
            
            .stat-value {
                font-size: 22px;
            }
            
            .filter-toggle-btn {
                display: none;
            }
            
            .controls {
                display: flex;
                flex-direction: row;
                flex-wrap: wrap;
                align-items: center;
                border-top: none;
                margin-top: 0;
                padding-top: 0;
            }
            
            .control-row {
                flex: 1;
            }
            
            .control-group {
                flex: 0 1 auto;
                min-width: auto;
            }
            
            .search-box {
                width: 180px;
            }
            
            .course-grid {
                grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
                gap: 20px;
            }
            
            .course-card {
                padding: 20px;
            }
            
            .course-name {
                font-size: 17px;
            }
            
            .main-content {
                padding: 24px;
            }
        }
        
        /* Mobile styles */
        @media (max-width: 768px) {
            .course-grid {
                grid-template-columns: 1fr;
            }
            
            .time-grid {
                grid-template-columns: 1fr;
            }
            
            .stats {
                gap: 12px;
            }
            
            .stat-value {
                font-size: 18px;
            }
            
            .stat-label {
                font-size: 9px;
            }
            
            .view-btn span:first-child {
                display: none;
            }
        }
        
        @media (max-width: 480px) {
            h1 {
                font-size: 15px;
            }
            
            .logo {
                width: 38px;
                height: 38px;
                font-size: 14px;
            }
            
            .subtitle {
                display: none;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="header-top">
                <div class="logo-section">
                    <div class="logo">ÊîøÂ§ß</div>
                    <div class="title-wrap">
                        <h1>ÊîøÊ≤ªÂ§ßÂ≠∏ EMBA Ë™≤Á®ãË≥áË®ä</h1>
                        <div class="subtitle">Course Schedule 2026</div>
                    </div>
                </div>
                <div class="stats">
                    <div class="stat">
                        <div class="stat-value" id="courseCount">18</div>
                        <div class="stat-label">Ë™≤Á®ã</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value selected" id="selectedCount">0</div>
                        <div class="stat-label">Â∑≤ÈÅ∏</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="totalCredits">0</div>
                        <div class="stat-label">Â≠∏ÂàÜ</div>
                    </div>
                </div>
            </div>
            <div class="view-row">
                <div class="view-toggle">
                    <button class="view-btn active" data-view="cards">
                        <span>üìã</span> ÂàóË°®
                    </button>
                    <button class="view-btn" data-view="timeslots">
                        <span>üïê</span> ÊôÇÊÆµ
                    </button>
                    <button class="view-btn" data-view="calendar">
                        <span>üìÖ</span> Ë°å‰∫ãÊõÜ
                    </button>
                </div>
                <button class="filter-toggle-btn" id="filterToggleBtn">
                    <span>üîç</span> ÁØ©ÈÅ∏
                    <span class="arrow">‚ñº</span>
                </button>
            </div>
            <div class="controls" id="controlsPanel">
                <div class="control-row">
                    <div class="control-group">
                        <span class="control-label">ÁµÑÂà•</span>
                        <select id="groupFilter">
                            <option value="all">ÂÖ®ÈÉ®ÁµÑÂà•</option>
                            <option value="ÂÖ®‰ºÅÁµÑ">ÂÖ®‰ºÅÁµÑ</option>
                            <option value="ÂúãÈáëÁµÑ">ÂúãÈáëÁµÑ</option>
                            <option value="ÁîüÈÜ´ÁµÑ">ÁîüÈÜ´ÁµÑ</option>
                            <option value="ÊñáÁßëË≥áÂâµÁµÑ">ÊñáÁßëË≥áÂâµÁµÑ</option>
                            <option value="‰∏çÂàÜÁµÑ">‰∏çÂàÜÁµÑ</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <span class="control-label">ÊôÇÊÆµ</span>
                        <select id="timeFilter">
                            <option value="all">ÂÖ®ÈÉ®ÊôÇÊÆµ</option>
                            <option value="ÈÄ±ÂÖ≠‰∏äÂçà">ÈÄ±ÂÖ≠‰∏äÂçà</option>
                            <option value="ÈÄ±ÂÖ≠‰∏ãÂçà">ÈÄ±ÂÖ≠‰∏ãÂçà</option>
                            <option value="ÈÄ±Êó•‰∏äÂçà">ÈÄ±Êó•‰∏äÂçà</option>
                            <option value="ÈÄ±Êó•‰∏ãÂçà">ÈÄ±Êó•‰∏ãÂçà</option>
                            <option value="ÈÄ±‰∏ÄÊôö‰∏ä">ÈÄ±‰∏ÄÊôö‰∏ä</option>
                            <option value="ÈÄ±ÂõõÊôö‰∏ä">ÈÄ±ÂõõÊôö‰∏ä</option>
                            <option value="ÈÄ±‰∫îÊôö‰∏ä">ÈÄ±‰∫îÊôö‰∏ä</option>
                            <option value="ÂÖ®Â§©">ÂÖ®Â§©Ë™≤Á®ã</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <span class="control-label">ÊéíÂ∫è</span>
                        <select id="sortOrder">
                            <option value="group">‰æùÁµÑÂà•</option>
                            <option value="date">‰æùÊó•Êúü</option>
                            <option value="credits">‰æùÂ≠∏ÂàÜ</option>
                            <option value="name">‰æùÂêçÁ®±</option>
                        </select>
                    </div>
                </div>
                <div class="control-row">
                    <input type="text" id="searchBox" class="search-box" placeholder="üîç ÊêúÂ∞ãË™≤Á®ãÊàñËÄÅÂ∏´...">
                    <button class="filter-toggle" id="showSelectedOnly">
                        ‚úì ÂÉÖÈ°ØÁ§∫Â∑≤ÈÅ∏
                    </button>
                    <button class="clear-btn" id="clearSelection">
                        ‚úï Ê∏ÖÈô§ÈÅ∏Êìá
                    </button>
                    <div class="save-indicator" id="saveIndicator">
                        <span>üíæ</span> Â∑≤Ëá™ÂãïÂÑ≤Â≠ò
                    </div>
                </div>
            </div>
        </div>
    </header>
    
    <main class="main-content">
        <div class="view-container active" id="cardsView">
            <div class="course-grid" id="courseGrid"></div>
        </div>
        <div class="view-container" id="timeslotsView">
            <div class="time-grid" id="timeGrid"></div>
        </div>
        <div class="view-container" id="calendarView">
            <div class="calendar-container" id="calendarContainer"></div>
        </div>
    </main>

    <script>
        const STORAGE_KEY = 'nccu_emba_selected_courses';
        
        const courses = [
            { id: 1, name: "ÂÖ®ÁêÉÁ∂ìÊøüËàá‰ºÅÊ•≠", group: "‰∏çÂàÜÁµÑ", teacher: "ÈÉ≠ÁÇ≥‰º∏ÔºàÊïôÊéàÔºâ", credits: 2, dates: ["03/19", "03/20", "04/23", "04/24"], time: "ÂÖ®Â§© 08:10-17:10", timeSlots: ["ÂÖ®Â§©"], firstDate: "03/19", timeType: "allday", reference: "https://service.emba.nccu.edu.tw/syllabus/uploads/syllabus_115_springB/40.‰∏çÂàÜÁµÑ_ÈÅ∏‰øÆ_932014501_ÂÖ®ÁêÉÁ∂ìÊøüËàá‰ºÅÊ•≠_ÈÉ≠ÁÇ≥‰º∏.pdf?20251231" },
            { id: 2, name: "ÂúãÂ≠∏ËàáÈ†òÂ∞éÂäõ", group: "‰∏çÂàÜÁµÑ", teacher: "ÊùéÁëûËèØÔºàÊ¶ÆË≠ΩÊïôÊéàÔºâ", credits: 2, dates: ["04/19", "04/20", "05/31", "06/01"], time: "ÂÖ®Â§© 08:30-17:30", timeSlots: ["ÂÖ®Â§©"], firstDate: "04/19", timeType: "allday", reference: "https://service.emba.nccu.edu.tw/syllabus/uploads/syllabus_115_springB/39.‰∏çÂàÜÁµÑ_ÈÅ∏‰øÆ_932453001_ÂúãÂ≠∏ËàáÈ†òÂ∞éÂäõ_ÊùéÁëûËèØ.pdf?20251231" },
            { id: 3, name: "Êï∏‰ΩçËàáÁ§æÁæ§Â™íÈ´îË°åÈä∑", group: "‰∏çÂàÜÁµÑ", teacher: "Èô≥ÂÜ†ÂÑíÔºàÂä©ÁêÜÊïôÊéàÔºâ", credits: 1, dates: ["03/12", "03/13"], time: "ÂÖ®Â§© 08:30-17:30", timeSlots: ["ÂÖ®Â§©"], firstDate: "03/12", timeType: "allday", reference: "https://service.emba.nccu.edu.tw/syllabus/uploads/syllabus_115_springB/41.‰∏çÂàÜÁµÑ__ÈÅ∏‰øÆ_932012-401_Êï∏‰ΩçËàáÁ§æÁæ§Â™íÈ´îË°åÈä∑_Èô≥ÂÜ†ÂÑí.pdf?20251231" },
            { id: 4, name: "Èä∑ÂîÆËàáÈ°ßÂÆ¢Èóú‰øÇÁÆ°ÁêÜÔºöÁ≠ñÁï•ËßÄ", group: "ÂÖ®‰ºÅÁµÑ", teacher: "Â∑´Á´ãÂÆáÔºàÂâØÊïôÊéàÔºâ", credits: 2, dates: ["03/07", "03/21", "04/11", "04/25", "05/09", "05/23", "06/06", "06/27"], time: "ÈÄ±ÂÖ≠ 08:30-12:30", timeSlots: ["ÈÄ±ÂÖ≠‰∏äÂçà"], firstDate: "03/07", timeType: "morning", reference: "https://service.emba.nccu.edu.tw/syllabus/uploads/syllabus_115_springB/02.ÂÖ®‰ºÅÁµÑ_2025Âπ¥Áè≠_ÈÅ∏‰øÆ_932444001_Èä∑ÂîÆËàáÈ°ßÂÆ¢Èóú‰øÇÁÆ°ÁêÜ_Â∑´Á´ãÂÆáËÄÅÂ∏´.pdf?20251231" },
            { id: 5, name: "Á≠ñÁï•Ë°åÈä∑ÂàÜÊûê-ÂÖ®ÁêÉËßÄÈªû", group: "ÂÖ®‰ºÅÁµÑ", teacher: "ÈÇ±ÂøóËÅñÔºàÊïôÊéàÔºâ„ÄÅËòáÂ®ÅÂÇëÔºàÊïôÊéàÔºâ", credits: 2, dates: ["03/14", "03/28", "04/18", "05/02", "05/16", "05/30", "06/13", "07/04"], time: "ÈÄ±ÂÖ≠ 08:30-12:30", timeSlots: ["ÈÄ±ÂÖ≠‰∏äÂçà"], firstDate: "03/14", timeType: "morning", reference: "https://service.emba.nccu.edu.tw/syllabus/uploads/syllabus_115_springB/05.ÂÖ®‰ºÅÁµÑ_2026Âπ¥Áè≠_Áæ§‰øÆ‰∫å_932072001_Á≠ñÁï•Ë°åÈä∑ÂàÜÊûê-ÂÖ®ÁêÉËßÄÈªû_ÈÇ±ÂøóËÅñ„ÄÅËòáÂ®ÅÂÇë.pdf?20251231" },
            { id: 6, name: "Ë°åÁÇ∫ÊäïË≥áËàáÂÖ¨Âè∏Ë©ïÂÉπ", group: "ÁîüÈÜ´ÁµÑ", teacher: "Âë®ÂÜ†Áî∑ÔºàÁâπËÅòÊïôÊéàÔºâ", credits: 2, dates: ["03/07", "03/21", "04/11", "04/25", "05/09", "05/18", "06/06", "06/27"], time: "ÈÄ±ÂÖ≠ 08:30-12:30„ÄÅÈÄ±‰∏Ä 18:30-22:30", timeSlots: ["ÈÄ±ÂÖ≠‰∏äÂçà", "ÈÄ±‰∏ÄÊôö‰∏ä"], firstDate: "03/07", timeType: "morning", reference: "https://service.emba.nccu.edu.tw/syllabus/uploads/syllabus_115_springB/22.ÁîüÈÜ´ÁµÑ_2025Âπ¥Áè≠_ÈÅ∏‰øÆ_932014-001_Ë°åÁÇ∫ÊäïË≥áËàáÂÖ¨Âè∏Ë©ïÂÉπ_Âë®ÂÜ†Áî∑.pdf?20251231" },
            { id: 7, name: "Ê∞∏Á∫åÈ†òÂ∞éÂäõËàáÂΩ±ÈüøÂäõÊäïË≥á", group: "ÂúãÈáëÁµÑ", teacher: "Ê•äÊõâÊñáÔºàÊïôÊéàÔºâ", credits: 2, dates: ["03/07", "03/27", "04/11", "04/25", "05/09", "05/23", "06/06", "06/27"], time: "ÈÄ±ÂÖ≠ 08:30-12:30„ÄÅÈÄ±‰∫î 18:30-22:30", timeSlots: ["ÈÄ±ÂÖ≠‰∏äÂçà", "ÈÄ±‰∫îÊôö‰∏ä"], firstDate: "03/07", timeType: "morning", reference: "https://service.emba.nccu.edu.tw/syllabus/uploads/syllabus_115_springB/16.ÂúãÈáëÁµÑ_2025Âπ¥Áè≠_ÈÅ∏‰øÆ_932017201_Ê∞∏Á∫åÈ†òÂ∞éÂäõËàáÂΩ±ÈüøÂäõÊäïË≥á_Ê•äÊõâÊñá.pdf?20251231" },
            { id: 8, name: "ÂÖ®ÁêÉÁî¢Ê•≠Á´∂Áà≠ÂàÜÊûê", group: "ÂÖ®‰ºÅÁµÑ", teacher: "Ê∫´ÂÅâ‰ªªÔºàÂä©ÁêÜÊïôÊéàÔºâ„ÄÅÊΩòÊåØÂÆáÔºàÂâØÊïôÊéàÔºâ", credits: 2, dates: ["03/07", "03/21", "04/11", "04/25", "05/09", "05/23", "06/06", "06/27"], time: "ÈÄ±ÂÖ≠ 13:30-17:30", timeSlots: ["ÈÄ±ÂÖ≠‰∏ãÂçà"], firstDate: "03/07", timeType: "afternoon", reference: "https://service.emba.nccu.edu.tw/syllabus/uploads/syllabus_115_springB/03.ÂÖ®‰ºÅÁµÑ_2025Âπ¥Áè≠_ÈÅ∏‰øÆ_932802001_ÂÖ®ÁêÉÁî¢Ê•≠Á´∂Áà≠ÂàÜÊûê_Ê∫´ÂÅâ‰ªª„ÄÅÊΩòÊåØÂÆá.pdf?20251231" },
            { id: 9, name: "Á´∂Áà≠ÂàÜÊûê-Â∞çÊäóËàáÂêà‰Ωú", group: "ÂÖ®‰ºÅÁµÑ", teacher: "ÈªÉÂúãÂ≥ØÔºàÁâπËÅòÊïôÊéàÔºâ„ÄÅÂΩ≠Êú±Â¶ÇÔºàÊïôÊéàÔºâ", credits: 2, dates: ["03/14", "03/28", "04/18", "05/02", "05/16", "05/30", "06/13", "07/04"], time: "ÈÄ±ÂÖ≠ 13:30-17:30", timeSlots: ["ÈÄ±ÂÖ≠‰∏ãÂçà"], firstDate: "03/14", timeType: "afternoon", reference: "https://service.emba.nccu.edu.tw/syllabus/uploads/syllabus_115_springB/06.ÂÖ®‰ºÅÁµÑ_2026Âπ¥Áè≠_Áæ§‰øÆ‰∫å_932309001_Á´∂Áà≠ÂàÜÊûê-Â∞çÊäóËàáÂêà‰Ωú_ÈªÉÂúãÂ≥Ø„ÄÅÂΩ≠Êú±Â¶Ç.pdf?20251231" },
            { id: 10, name: "Èä∑ÂîÆËàáÈ°ßÂÆ¢Èóú‰øÇÁÆ°ÁêÜÔºöÁ≠ñÁï•ËßÄ", group: "ÂúãÈáëÁµÑ", teacher: "Â∑´Á´ãÂÆáÔºàÂâØÊïôÊéàÔºâ", credits: 2, dates: ["03/07", "03/21", "04/11", "04/25", "05/09", "05/23", "06/06", "06/27"], time: "ÈÄ±ÂÖ≠ 13:30-17:30", timeSlots: ["ÈÄ±ÂÖ≠‰∏ãÂçà"], firstDate: "03/07", timeType: "afternoon", reference: "https://service.emba.nccu.edu.tw/syllabus/uploads/syllabus_115_springB/17.ÂúãÈáëÁµÑ_2025Âπ¥Áè≠_ÈÅ∏‰øÆ_932439001_Èä∑ÂîÆËàáÈ°ßÂÆ¢ÈóúÁÆ°ÁêÜÁ≠ñÁï•ËßÄ_Â∑´Á´ãÂÆá.pdf?20251231" },
            { id: 11, name: "Êñ∞Â∏∏ÊÖã‰∏ãÁöÑÊï∏‰ΩçËΩâÂûã", group: "ÊñáÁßëË≥áÂâµÁµÑ", teacher: "Ë©πÊñáÁî∑ÔºàË≥áÊ∑±Áî¢Ê•≠È°ßÂïèÔºâ", credits: 2, dates: ["03/14", "03/28", "04/18", "05/02", "05/16", "05/30", "06/13", "07/04"], time: "ÈÄ±ÂÖ≠ 13:30-17:30", timeSlots: ["ÈÄ±ÂÖ≠‰∏ãÂçà"], firstDate: "03/14", timeType: "afternoon", reference: "https://service.emba.nccu.edu.tw/syllabus/uploads/syllabus_115_springB/14.ÊñáÁßëË≥áÂâµÁµÑ_2026Âπ¥Áè≠_Áæ§‰øÆ‰∫å_932015901_Êñ∞Â∏∏ÊÖã‰∏ãÁöÑÊï∏‰ΩçËΩâÂûã_Ë©πÊñáÁî∑.pdf?20251231" },
            { id: 12, name: "Á∂ìÊøüÂàÜÊûêËàáÁÆ°ÁêÜÊ±∫Á≠ñ", group: "‰∏çÂàÜÁµÑ", teacher: "Ê∫´ÂÅâ‰ªªÔºàÂä©ÁêÜÊïôÊéàÔºâ", credits: 2, dates: ["03/08", "03/22", "04/12", "05/10", "05/24", "06/07", "06/28", "07/19"], time: "ÈÄ±Êó• 08:30-12:30", timeSlots: ["ÈÄ±Êó•‰∏äÂçà"], firstDate: "03/08", timeType: "morning", reference: "https://service.emba.nccu.edu.tw/syllabus/uploads/syllabus_115_springB/42.‰∏çÂàÜÁµÑ_ÈÅ∏‰øÆ_932464-001_Á∂ìÊøüÂàÜÊûêËàáÁÆ°ÁêÜÊ±∫Á≠ñ_Ê∫´ÂÅâ‰ªª.pdf?20251231" },
            { id: 13, name: "ÂâµÊ•≠ËàáÊñ∞‰∫ãÊ•≠ÁôºÂ±ï", group: "ÊñáÁßëË≥áÂâµÁµÑ", teacher: "ÈÑ≠Ëá≥Áî´ÔºàÊïôÊéàÔºâ", credits: 2, dates: ["03/09", "03/28", "04/18", "05/02", "05/16", "05/30", "06/22", "07/04"], time: "ÈÄ±ÂÖ≠ 08:30-12:30„ÄÅÈÄ±‰∏Ä 18:30-22:30", timeSlots: ["ÈÄ±ÂÖ≠‰∏äÂçà", "ÈÄ±‰∏ÄÊôö‰∏ä"], firstDate: "03/09", timeType: "morning", reference: "https://service.emba.nccu.edu.tw/syllabus/uploads/syllabus_115_springB/13.ÊñáÁßëË≥áÂâµÁµÑ_2026Âπ¥Áè≠_Áæ§‰øÆ‰∫å_932303001_ÂâµÊ•≠ËàáÊñ∞‰∫ãÊ•≠ÁôºÂ±ï_ÈÑ≠Ëá≥Áî´.pdf?20251231" },
            { id: 14, name: "Á≠ñÁï•Ê∞∏Á∫åÁ∂ìÁáü", group: "ÂÖ®‰ºÅÁµÑ", teacher: "ËòáÂ®ÅÂÇëÔºàÊïôÊéàÔºâ„ÄÅÊΩòÊåØÂÆáÔºàÂâØÊïôÊéàÔºâ", credits: 2, dates: ["03/08", "03/22", "04/12", "05/10", "05/24", "06/07", "06/28", "07/19"], time: "ÈÄ±Êó• 13:30-17:30", timeSlots: ["ÈÄ±Êó•‰∏ãÂçà"], firstDate: "03/08", timeType: "afternoon", reference: "https://service.emba.nccu.edu.tw/syllabus/uploads/syllabus_115_springB/04.ÂÖ®‰ºÅÁµÑ_2025Áè≠_ÈÅ∏‰øÆ_932011001_Á≠ñÁï•Ê∞∏Á∫åÁ∂ìÁáü_ËòáÂ®ÅÂÇë„ÄÅÊΩòÊåØÂÆá.pdf?20251231" },
            { id: 15, name: "ÂçÄÂ°äÈèàËàáËôõÊì¨Ë≤®Âπ£ÔºöÂïÜÊ•≠ÂâµÊñ∞ËàáÊáâÁî®", group: "ÊñáÁßëË≥áÂâµÁµÑ", teacher: "Èô≥ÊÅ≠ÔºàÊïôÊéàÔºâ", credits: 1, dates: ["05/24", "06/07", "06/28", "07/19"], time: "ÈÄ±Êó• 13:30-17:30", timeSlots: ["ÈÄ±Êó•‰∏ãÂçà"], firstDate: "05/24", timeType: "afternoon", reference: "https://service.emba.nccu.edu.tw/syllabus/uploads/syllabus_115_springB/11.ÊñáÁßëË≥áÂâµÁµÑ_2025Âπ¥Áè≠_ÈÅ∏‰øÆ_932012701_ÂçÄÂ°äÈèàËàáËôõÊì¨Ë≤®Âπ£ÔºöÂïÜÊ•≠ÂâµÊñ∞ËàáÊáâÁî®_Èô≥ÊÅ≠(1Â≠∏ÂàÜ).pdf?20251231" },
            { id: 16, name: "Ë∑®ÂúãÁ∂ìÁáüËàáÂúãÈöõË≤°ÂãôÁ≠ñÁï•", group: "ÂúãÈáëÁµÑ", teacher: "ÂºµÂÖÉÊô®ÔºàÊïôÊéàÔºâ", credits: 2, dates: ["03/08", "03/22", "04/12", "05/04", "05/10", "05/24", "06/07", "06/28"], time: "ÈÄ±Êó• 13:30-17:30„ÄÅÈÄ±‰∏Ä 18:30-22:30", timeSlots: ["ÈÄ±Êó•‰∏ãÂçà", "ÈÄ±‰∏ÄÊôö‰∏ä"], firstDate: "03/08", timeType: "afternoon", reference: "https://service.emba.nccu.edu.tw/syllabus/uploads/syllabus_115_springB/18.ÂúãÈáëÁµÑ_2025Âπ¥Áè≠_ÈÅ∏‰øÆ_932498001_Ë∑®ÂúãÁ∂ìÁáüËàáÂúãÈöõË≤°ÂãôÁ≠ñÁï•_ÂºµÂÖÉÊô®.pdf?20251231" },
            { id: 17, name: "ÂïÜÊ•≠Ë≥áÊñôÂàÜÊûêËàáÁÆ°ÁêÜÊ±∫Á≠ñ", group: "‰∏çÂàÜÁµÑ", teacher: "‰ΩôÊ∏ÖÁ••ÔºàÊïôÊéàÔºâ", credits: 2, dates: ["03/08", "03/22", "04/12", "04/27", "05/10", "05/24", "06/07", "06/28"], time: "ÈÄ±Êó• 13:30-17:30„ÄÅÈÄ±‰∏Ä 18:30-22:30", timeSlots: ["ÈÄ±Êó•‰∏ãÂçà", "ÈÄ±‰∏ÄÊôö‰∏ä"], firstDate: "03/08", timeType: "afternoon", reference: "https://service.emba.nccu.edu.tw/syllabus/uploads/syllabus_115_springB/43.‰∏çÂàÜÁµÑ_ÈÅ∏‰øÆ_932465001_ÂïÜÊ•≠Ë≥áÊñôÂàÜÊûêËàáÁÆ°ÁêÜÊ±∫Á≠ñ_‰ΩôÊ∏ÖÁ••.pdf?20251231" },
            { id: 18, name: "‰∫∫Â∑•Êô∫ÊÖßËàáÊï∏‰ΩçÊ≤ªÁêÜ", group: "ÊñáÁßëË≥áÂâµÁµÑ", teacher: "ËéäÂºòÈà∫ÔºàÂâØÊïôÊéàÔºâ", credits: 1, dates: ["03/08", "03/26", "04/12", "05/10"], time: "ÈÄ±Êó• 13:30-17:30„ÄÅÈÄ±Âõõ 18:30-22:30", timeSlots: ["ÈÄ±Êó•‰∏ãÂçà", "ÈÄ±ÂõõÊôö‰∏ä"], firstDate: "03/08", timeType: "afternoon", reference: "https://service.emba.nccu.edu.tw/syllabus/uploads/syllabus_115_springB/10.ÊñáÁßëË≥áÂâµÁµÑ_2025Âπ¥Áè≠_ÈÅ∏‰øÆ_932016901_‰∫∫Â∑•Êô∫ÊÖßËàáÊï∏‰ΩçÊ≤ªÁêÜ_ËéäÂºòÈà∫.pdf?20251231" }
        ];

        const groupOrder = ["ÂÖ®‰ºÅÁµÑ", "ÂúãÈáëÁµÑ", "ÁîüÈÜ´ÁµÑ", "ÊñáÁßëË≥áÂâµÁµÑ", "‰∏çÂàÜÁµÑ"];
        
        const timeSlotConfig = {
            "ÈÄ±ÂÖ≠‰∏äÂçà": { icon: "üåÖ", label: "ÈÄ±ÂÖ≠‰∏äÂçà", time: "08:30-12:30" },
            "ÈÄ±ÂÖ≠‰∏ãÂçà": { icon: "‚òÄÔ∏è", label: "ÈÄ±ÂÖ≠‰∏ãÂçà", time: "13:30-17:30" },
            "ÈÄ±Êó•‰∏äÂçà": { icon: "üåÖ", label: "ÈÄ±Êó•‰∏äÂçà", time: "08:30-12:30" },
            "ÈÄ±Êó•‰∏ãÂçà": { icon: "‚òÄÔ∏è", label: "ÈÄ±Êó•‰∏ãÂçà", time: "13:30-17:30" },
            "ÈÄ±‰∏ÄÊôö‰∏ä": { icon: "üåô", label: "ÈÄ±‰∏ÄÊôö‰∏ä", time: "18:30-22:30" },
            "ÈÄ±ÂõõÊôö‰∏ä": { icon: "üåô", label: "ÈÄ±ÂõõÊôö‰∏ä", time: "18:30-22:30" },
            "ÈÄ±‰∫îÊôö‰∏ä": { icon: "üåô", label: "ÈÄ±‰∫îÊôö‰∏ä", time: "18:30-22:30" },
            "ÂÖ®Â§©": { icon: "üìÜ", label: "ÂÖ®Â§©Ë™≤Á®ã", time: "08:00-17:30" }
        };

        const timeSlotOrder = ["ÈÄ±ÂÖ≠‰∏äÂçà", "ÈÄ±ÂÖ≠‰∏ãÂçà", "ÈÄ±Êó•‰∏äÂçà", "ÈÄ±Êó•‰∏ãÂçà", "ÈÄ±‰∏ÄÊôö‰∏ä", "ÈÄ±ÂõõÊôö‰∏ä", "ÈÄ±‰∫îÊôö‰∏ä", "ÂÖ®Â§©"];
        
        const timeSymbols = {
            morning: { symbol: "‚ñ≥", class: "morning", label: "‰∏äÂçà" },
            afternoon: { symbol: "‚ñ≤", class: "afternoon", label: "‰∏ãÂçà" },
            evening: { symbol: "‚óè", class: "evening", label: "Êôö‰∏ä" },
            allday: { symbol: "‚óÜ", class: "allday", label: "ÂÖ®Â§©" }
        };

        // Load from localStorage
        let selectedCourses = new Set();
        let showSelectedOnly = false;
        
        function loadFromStorage() {
            try {
                const saved = localStorage.getItem(STORAGE_KEY);
                if (saved) {
                    const ids = JSON.parse(saved);
                    selectedCourses = new Set(ids);
                }
            } catch (e) {
                console.log('ÁÑ°Ê≥ïËÆÄÂèñÊú¨Âú∞ÂÑ≤Â≠ò');
            }
        }
        
        function saveToStorage() {
            try {
                const ids = Array.from(selectedCourses);
                localStorage.setItem(STORAGE_KEY, JSON.stringify(ids));
                showSaveIndicator();
            } catch (e) {
                console.log('ÁÑ°Ê≥ïÂØ´ÂÖ•Êú¨Âú∞ÂÑ≤Â≠ò');
            }
        }
        
        function showSaveIndicator() {
            const indicator = document.getElementById('saveIndicator');
            indicator.classList.add('saved');
            setTimeout(() => {
                indicator.classList.remove('saved');
            }, 2000);
        }
        
        function clearSelection() {
            if (confirm('Á¢∫ÂÆöË¶ÅÊ∏ÖÈô§ÊâÄÊúâÂ∑≤ÈÅ∏Ë™≤Á®ãÂóéÔºü')) {
                selectedCourses.clear();
                saveToStorage();
                filterAndRender();
            }
        }

        function parseDateForSort(dateStr) {
            const match = dateStr.match(/(\d{2})\/(\d{2})/);
            if (match) {
                return parseInt(match[1]) * 100 + parseInt(match[2]);
            }
            return 999;
        }

        function getFilteredCourses() {
            const groupFilter = document.getElementById('groupFilter').value;
            const timeFilter = document.getElementById('timeFilter').value;
            const sortOrder = document.getElementById('sortOrder').value;
            const searchTerm = document.getElementById('searchBox').value.toLowerCase();

            let filtered = courses.filter(course => {
                const matchGroup = groupFilter === 'all' || course.group === groupFilter;
                const matchTime = timeFilter === 'all' || course.timeSlots.includes(timeFilter);
                const matchSearch = !searchTerm || 
                    course.name.toLowerCase().includes(searchTerm) ||
                    course.teacher.toLowerCase().includes(searchTerm) ||
                    course.group.toLowerCase().includes(searchTerm);
                const matchSelected = !showSelectedOnly || selectedCourses.has(course.id);
                return matchGroup && matchTime && matchSearch && matchSelected;
            });

            filtered.sort((a, b) => {
                switch(sortOrder) {
                    case 'date':
                        return parseDateForSort(a.firstDate) - parseDateForSort(b.firstDate);
                    case 'credits':
                        return b.credits - a.credits;
                    case 'name':
                        return a.name.localeCompare(b.name, 'zh-TW');
                    case 'group':
                    default:
                        return groupOrder.indexOf(a.group) - groupOrder.indexOf(b.group);
                }
            });

            return filtered;
        }

        function toggleCourse(id) {
            if (selectedCourses.has(id)) {
                selectedCourses.delete(id);
            } else {
                selectedCourses.add(id);
            }
            saveToStorage();
            filterAndRender();
        }
        
        function openSyllabus(url, event) {
            event.preventDefault();
            event.stopPropagation();
            window.open(url, '_blank');
        }

        function renderCourseCards(filteredCourses) {
            const grid = document.getElementById('courseGrid');
            
            if (filteredCourses.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üìö</div>
                        <div>Ê≤íÊúâÊâæÂà∞Á¨¶ÂêàÊ¢ù‰ª∂ÁöÑË™≤Á®ã</div>
                    </div>
                `;
                return;
            }

            grid.innerHTML = filteredCourses.map(course => {
                const dateChips = course.dates.map(d => 
                    `<span class="date-chip">${d}</span>`
                ).join('');
                
                const timeChips = course.timeSlots.map(t => 
                    `<span class="time-chip">${t}</span>`
                ).join('');
                
                const isSelected = selectedCourses.has(course.id);
                
                const referenceLink = course.reference ? 
                    `<a href="${course.reference}" target="_blank" rel="noopener noreferrer" class="syllabus-link" onclick="openSyllabus('${course.reference}', event)">
                        üìÑ Ë™≤Á®ãÂ§ßÁ∂±
                    </a>` : '';

                return `
                    <div class="course-card ${isSelected ? 'selected' : ''}" data-group="${course.group}" data-id="${course.id}">
                        <div class="card-header">
                            <div class="card-checkbox">
                                <div class="checkbox-wrapper">
                                    <input type="checkbox" ${isSelected ? 'checked' : ''} onchange="toggleCourse(${course.id})">
                                    <div class="checkbox-custom"></div>
                                </div>
                                <div class="course-name">${course.name}</div>
                            </div>
                            <span class="group-badge" data-group="${course.group}">${course.group}</span>
                        </div>
                        <div class="card-info">
                            <div class="info-row">
                                <div class="info-icon">üë®‚Äçüè´</div>
                                <div class="info-content">
                                    <div class="info-label">ÊéàË™≤ÊïôÊéà</div>
                                    <div class="info-value">${course.teacher}</div>
                                </div>
                            </div>
                            <div class="info-row">
                                <div class="info-icon">üéì</div>
                                <div class="info-content">
                                    <div class="info-label">Â≠∏ÂàÜÊï∏</div>
                                    <div class="info-value" style="display:flex;align-items:center;gap:10px;flex-wrap:wrap;">
                                        <span class="credits-badge">${course.credits} Â≠∏ÂàÜ</span>
                                        ${referenceLink}
                                    </div>
                                </div>
                            </div>
                            <div class="info-row">
                                <div class="info-icon">üïê</div>
                                <div class="info-content">
                                    <div class="info-label">‰∏äË™≤ÊôÇÊÆµ</div>
                                    <div class="time-chips">${timeChips}</div>
                                </div>
                            </div>
                            <div class="info-row">
                                <div class="info-icon">üìÖ</div>
                                <div class="info-content">
                                    <div class="info-label">Ë™≤Á®ãÊó•Êúü</div>
                                    <div class="date-chips">${dateChips}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderTimeSlotView(filteredCourses) {
            const grid = document.getElementById('timeGrid');
            
            const coursesBySlot = {};
            timeSlotOrder.forEach(slot => {
                coursesBySlot[slot] = [];
            });
            
            filteredCourses.forEach(course => {
                course.timeSlots.forEach(slot => {
                    if (coursesBySlot[slot]) {
                        coursesBySlot[slot].push(course);
                    }
                });
            });

            const slotsWithCourses = timeSlotOrder.filter(slot => coursesBySlot[slot].length > 0);
            
            if (slotsWithCourses.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üïê</div>
                        <div>Ê≤íÊúâÊâæÂà∞Á¨¶ÂêàÊ¢ù‰ª∂ÁöÑË™≤Á®ãÊôÇÊÆµ</div>
                    </div>
                `;
                return;
            }

            grid.innerHTML = slotsWithCourses.map(slot => {
                const config = timeSlotConfig[slot];
                const slotCourses = coursesBySlot[slot];
                
                const coursesHtml = slotCourses.map(course => {
                    const isSelected = selectedCourses.has(course.id);
                    return `
                        <div class="time-course-item ${isSelected ? 'selected' : ''}" onclick="toggleCourse(${course.id})">
                            <div class="time-course-name">${isSelected ? '‚úì ' : ''}${course.name}</div>
                            <div class="time-course-meta">
                                <span class="time-course-tag group">${course.group}</span>
                                <span class="time-course-tag">${course.credits} Â≠∏ÂàÜ</span>
                                <span class="time-course-tag">${course.teacher.split('Ôºà')[0]}</span>
                            </div>
                        </div>
                    `;
                }).join('');

                return `
                    <div class="time-slot-card">
                        <div class="time-slot-header">
                            <div class="time-slot-title">
                                <span class="time-slot-icon">${config.icon}</span>
                                <span>${config.label}</span>
                                <span style="color: #888; font-weight: 400; font-size: 12px;">${config.time}</span>
                            </div>
                            <span class="time-slot-count">${slotCourses.length} ÈñÄ</span>
                        </div>
                        <div class="time-slot-courses">
                            ${coursesHtml}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderCalendarView(filteredCourses) {
            const container = document.getElementById('calendarContainer');
            
            const allDates = [];
            const months = [
                { month: 3, name: '3Êúà', days: 31 },
                { month: 4, name: '4Êúà', days: 30 },
                { month: 5, name: '5Êúà', days: 31 },
                { month: 6, name: '6Êúà', days: 30 },
                { month: 7, name: '7Êúà', days: 31 }
            ];
            
            months.forEach(m => {
                for (let d = 1; d <= m.days; d++) {
                    const dateStr = `${String(m.month).padStart(2, '0')}/${String(d).padStart(2, '0')}`;
                    const date = new Date(2026, m.month - 1, d);
                    const dayOfWeek = date.getDay();
                    allDates.push({
                        dateStr,
                        day: d,
                        month: m.month,
                        monthName: m.name,
                        isWeekend: dayOfWeek === 0 || dayOfWeek === 6,
                        isMonthStart: d === 1,
                        dayOfWeek
                    });
                }
            });

            const weekDays = ['Êó•', '‰∏Ä', '‰∫å', '‰∏â', 'Âõõ', '‰∫î', 'ÂÖ≠'];
            let dateHeaders = '';
            allDates.forEach(d => {
                const monthClass = d.isMonthStart && d.month > 3 ? 'month-divider' : '';
                dateHeaders += `
                    <div class="date-header ${d.isWeekend ? 'weekend' : ''} ${monthClass}">
                        ${d.isMonthStart ? `<div style="font-size:8px;color:#4dabf7;">${d.monthName}</div>` : ''}
                        <div class="day-num">${d.day}</div>
                    </div>
                `;
            });

            const courseRows = filteredCourses.map(course => {
                const isSelected = selectedCourses.has(course.id);
                const courseDates = new Set(course.dates.map(d => d.replace(/\([^)]+\)/, '')));
                const timeConfig = timeSymbols[course.timeType];
                
                const dateCells = allDates.map(d => {
                    const hasClass = courseDates.has(d.dateStr);
                    return `
                        <div class="date-cell ${d.isWeekend ? 'weekend' : ''} ${hasClass ? 'has-class' : ''} ${hasClass && isSelected ? 'selected' : ''} ${d.isMonthStart && d.month > 3 ? 'month-divider' : ''}">
                            ${hasClass ? `<span class="date-marker ${timeConfig.class}">${timeConfig.symbol}</span>` : ''}
                        </div>
                    `;
                }).join('');

                return `
                    <div class="calendar-row ${isSelected ? 'selected' : ''}" onclick="toggleCourse(${course.id})">
                        <div class="calendar-row-label">
                            <div class="group-indicator" data-group="${course.group}"></div>
                            <span style="flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;" title="${course.name}">${course.name}</span>
                            ${isSelected ? '<span style="color:#51cf66;flex-shrink:0;">‚úì</span>' : ''}
                        </div>
                        <div class="calendar-row-dates">
                            ${dateCells}
                        </div>
                    </div>
                `;
            }).join('');

            container.innerHTML = `
                <div class="calendar-header">
                    <div class="calendar-title">
                        <span>üìÖ</span> 2026 Â≠∏ÊúüË™≤Á®ãË°å‰∫ãÊõÜ
                    </div>
                    <div class="calendar-legend">
                        <div class="legend-item"><div class="legend-dot" data-group="ÂÖ®‰ºÅÁµÑ"></div><span>ÂÖ®‰ºÅ</span></div>
                        <div class="legend-item"><div class="legend-dot" data-group="ÂúãÈáëÁµÑ"></div><span>ÂúãÈáë</span></div>
                        <div class="legend-item"><div class="legend-dot" data-group="ÁîüÈÜ´ÁµÑ"></div><span>ÁîüÈÜ´</span></div>
                        <div class="legend-item"><div class="legend-dot" data-group="ÊñáÁßëË≥áÂâµÁµÑ"></div><span>ÊñáË≥á</span></div>
                        <div class="legend-item"><div class="legend-dot" data-group="‰∏çÂàÜÁµÑ"></div><span>‰∏çÂàÜ</span></div>
                        <div class="legend-item"><div class="legend-dot selected"></div><span>Â∑≤ÈÅ∏</span></div>
                    </div>
                </div>
                <div class="time-legend">
                    <span style="color:#888;font-size:11px;margin-right:6px;">ÊôÇÊÆµÔºö</span>
                    <div class="time-legend-item"><span class="time-symbol morning">‚ñ≥</span><span>‰∏äÂçà</span></div>
                    <div class="time-legend-item"><span class="time-symbol afternoon">‚ñ≤</span><span>‰∏ãÂçà</span></div>
                    <div class="time-legend-item"><span class="time-symbol evening">‚óè</span><span>Êôö‰∏ä</span></div>
                    <div class="time-legend-item"><span class="time-symbol allday">‚óÜ</span><span>ÂÖ®Â§©</span></div>
                </div>
                <div class="calendar-body">
                    <div class="calendar-timeline">
                        <div class="date-header-row">
                            <div class="date-header-spacer"></div>
                            <div class="date-headers">
                                ${dateHeaders}
                            </div>
                        </div>
                        ${courseRows}
                    </div>
                </div>
            `;
        }

        function updateStats(filteredCourses) {
            document.getElementById('courseCount').textContent = filteredCourses.length;
            document.getElementById('selectedCount').textContent = selectedCourses.size;
            
            const selectedCredits = courses
                .filter(c => selectedCourses.has(c.id))
                .reduce((sum, c) => sum + c.credits, 0);
            document.getElementById('totalCredits').textContent = selectedCredits;
        }

        function filterAndRender() {
            const filtered = getFilteredCourses();
            renderCourseCards(filtered);
            renderTimeSlotView(filtered);
            renderCalendarView(filtered);
            updateStats(filtered);
        }

        // View toggle
        document.querySelectorAll('.view-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                const view = btn.dataset.view;
                document.querySelectorAll('.view-container').forEach(v => v.classList.remove('active'));
                document.getElementById(view + 'View').classList.add('active');
            });
        });

        // Filter toggle for mobile
        document.getElementById('filterToggleBtn').addEventListener('click', function() {
            const panel = document.getElementById('controlsPanel');
            panel.classList.toggle('show');
            this.classList.toggle('active');
        });

        // Show selected only toggle
        document.getElementById('showSelectedOnly').addEventListener('click', function() {
            showSelectedOnly = !showSelectedOnly;
            this.classList.toggle('active', showSelectedOnly);
            filterAndRender();
        });
        
        // Clear selection
        document.getElementById('clearSelection').addEventListener('click', clearSelection);

        // Filter event listeners
        document.getElementById('groupFilter').addEventListener('change', filterAndRender);
        document.getElementById('timeFilter').addEventListener('change', filterAndRender);
        document.getElementById('sortOrder').addEventListener('change', filterAndRender);
        document.getElementById('searchBox').addEventListener('input', filterAndRender);

        // Load saved data and initial render
        loadFromStorage();
        filterAndRender();
    </script>
</body>
</html>
